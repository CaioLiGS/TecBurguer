@model TecBurguer.Models.Hamburguer
@using Microsoft.AspNetCore.Identity
@using TecBurguer.Areas.Identity.Data

@{
    ViewData["Title"] = Model.Nome;
}

@inject UserManager<LoginCliente> UserManager
@inject SignInManager<LoginCliente> SignInManager


<link href="~/css/Details.css" rel="stylesheet" />

<div class="product-page-container">

    <div class="product-image-column">
        <img src="@Model.Imagem" alt="Imagem do @Model.Nome" class="product-image" />

        <div id="FacaLogin" class="interface">
            <img src="~/css/Imagens/BurguerLogo.png">
            <div>
                <h3>Quer fazer um pedido?</h3>
                <p>Crie uma conta ou faça login para prosseguir com o pedido.</p>
                <div>
                    <a class="BotaoCriarConta" asp-area="Identity" asp-page="/Account/Register">
                        Criar conta
                    </a>
                    <a class="BotaoLogin" asp-area="Identity" asp-page="/Account/Login">
                        Login
                    </a>

                </div>
            </div>
        </div>

        @if (SignInManager.IsSignedIn(User))
        {
            <a class="order-button" onclick="adicionarAoCarrinho('@Model.Nome', @Model.Preco, '@Model.IdHamburguer', '@UserManager.GetUserName(User)')">

                <img src="~/css/Imagens/IconCart.png" alt="Ícone" class="button-icon" />

                <span class="button-text">Começar pedido</span>

            </a>
        }
        else
        {
            <a class="order-button" onclick="mostrarBotaoLogin()">

                <img src="~/css/Imagens/IconCart.png" alt="Ícone" class="button-icon" />

                <span class="button-text">Começar pedido</span>

            </a>
        }
    </div>

    <div class="product-details-column">

        <h1 class="product-title">@Model.Nome</h1>

        <p class="product-description">
            @Model.Descricao
        </p>

        <div class="accordion-container">
            <div class="accordion-item">

                <button type="button" class="accordion-trigger">
                    <span class="accordion-title">Ingredientes</span>
                    <span class="accordion-arrow">&#9660;</span>
                </button>

                <div class="accordion-content">

                    <ul style="text-align: left; margin-left: 20px; font-size: 1.25rem; padding-inline-start: 25px;">
                        
                        @foreach (var ingrediente in @Model.HamburguerIgredientes)
                        {
                            @if (ingrediente.IdIngredienteNavigation != null)
                            {
                                <li>@ingrediente.IdIngredienteNavigation.Nome</li>
                            }
                        }
                    </ul>

                </div>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        document.addEventListener("DOMContentLoaded", function() {

            const accordionTriggers = document.querySelectorAll(".accordion-trigger");

            accordionTriggers.forEach(trigger => {
                trigger.addEventListener("click", function() {

                    // Gira a seta
                    this.classList.toggle("active");

                    // Pega o conteúdo (o div da lista <ul>)
                    const content = this.nextElementSibling;

                    // Abre ou fecha
                    if (content.style.maxHeight) {
                        content.style.maxHeight = null; // Fecha
                    } else {
                        content.style.maxHeight = content.scrollHeight + "px"; // Abre
                    }
                });
            });
        });
    </script>
