@page
@model RegisterModel

<link rel="stylesheet" href="~/css/Register.css" asp-append-version="true">

<!-- Background Circles -->
<div class="Ball1"></div>
<div class="Ball3"></div>

@{
    ViewData["Title"] = "Registro";
}

<div class="OutBox">
    <!-- Registration Box -->
    <div class="Box" id="LeftBox">
        <form id="registerForm" asp-route-returnUrl="@Model.ReturnUrl" method="post">
            <div class="content-inputs">
                <h2 class="TextoComImagem">Criar nova conta</h2>
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>

                <span asp-validation-for="Input.Nome" class="text-danger"></span>
                <div class="input-icon-group">
                    <span class="input-icon">
                        <!-- User Icon -->
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm4-3a4 4 0 1 1-8 0 4 4 0 0 1 8 0z" />
                            <path fill-rule="evenodd" d="M14 14s-1-1.5-6-1.5S2 14 2 14V13a6 6 0 1 1 12 0v1z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input asp-for="Input.Nome" class="form-control" autocomplete="username" required placeholder=" "/>
                        <label asp-for="Input.Nome"></label>
                        
                    </div>
                </div>

                <span asp-validation-for="Input.Email" class="text-danger"></span>
                <div class="input-icon-group">
                    <span class="input-icon">
                        <!-- Email Icon -->
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.383V5.383zm-.034 6.434-5.966-3.583-5.966 3.583A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-1.183zM1 5.383v6l4.708-3.175L1 5.383z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input asp-for="Input.Email" class="form-control" autocomplete="username" required placeholder=" "/>
                        <label asp-for="Input.Email"></label>
                        
                    </div>
                </div>

                <span asp-validation-for="Input.Password" class="text-danger"></span>
                <div class="input-icon-group">
                    <span class="input-icon">
                        <!-- Lock Icon -->
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 8V7a5 5 0 0 0-10 0v1a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-8a3 3 0 0 0-3-3zm-8-1a3 3 0 0 1 6 0v1H9V7zm10 12a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input asp-for="Input.Password" class="form-control" autocomplete="new-password" required placeholder=" "/>
                        <label asp-for="Input.Password">Senha</label>
                       
                    </div>
                    
                </div>

                <span asp-validation-for="Input.ConfirmPassword" class="text-danger"></span>
                <div class="input-icon-group">
                    <span class="input-icon">
                        <!-- Lock Icon -->
                         <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 8V7a5 5 0 0 0-10 0v1a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-8a3 3 0 0 0-3-3zm-8-1a3 3 0 0 1 6 0v1H9V7zm10 12a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input asp-for="Input.ConfirmPassword" class="form-control" autocomplete="new-password" placeholder=" " required />
                        <label asp-for="Input.ConfirmPassword">Confirmar senha</label>
                        
                    </div>
                    
                </div>
                
                
            </div>

            <button id="registerSubmit" type="submit">
                <span class="button-text">Criar conta</span>
                <span class="spinner" style="display:none;"></span>
            </button>
        </form>

        
    </div>

    <!-- Login Box -->
    <div class="Box" id="MidBox">
        <form>
            <div>
                <h2 class="TextoComImagem2">Entrar na conta</h2>
                <div asp-validation-summary="ModelOnly" class="text-danger"></div>


                <!-- Email Field (Login) -->
                <div class="input-icon-group2">
                    <span class="input-icon">
                        <!-- Email Icon -->
                        <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                            <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2zm13 2.383-4.708 2.825L15 11.383V5.383zm-.034 6.434-5.966-3.583-5.966 3.583A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-1.183zM1 5.383v6l4.708-3.175L1 5.383z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input class="form-control" placeholder=" " />
                        <label>Email</label>
                    </div>
                </div>

                <!-- Password Field (Login) -->
                <div class="input-icon-group2">
                    <span class="input-icon">
                       <!-- Lock Icon -->
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17 8V7a5 5 0 0 0-10 0v1a3 3 0 0 0-3 3v8a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3v-8a3 3 0 0 0-3-3zm-8-1a3 3 0 0 1 6 0v1H9V7zm10 12a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v8z" />
                        </svg>
                    </span>
                    <div class="form-floating">
                        <input class="form-control" placeholder=" " />
                        <label>Senha</label>
                    </div>
                </div>

                <div class="links">

                    <label class="form-label">
                        <input class="form-check-input" />
                        Lembre-me neste dispositivo
                    </label>


                    <p>
                        <a id="forgot-password" asp-page="./ForgotPassword">Esqueceu sua senha?</a>
                    </p>

                </div>

            </div>
            

            <!-- Login Button -->
            <button id="loginSubmit" type="submit">Login</button>
        </form>
    </div>

    <!-- Information Box -->
    <div class="Box" id="RightBox">

        <div>
            <img src="~/css/Imagens/BurguerLogo.png" alt="TecBurguer Logo">
            <h1>TecBurger</h1>
        </div>
        

        @if (ViewData["ShowConfirmation"] as bool? == true)
        { 
            <form method="post" asp-page-handler="Confirm">

                <h2>Confirmação de Email</h2>

                <div class="form-floating confirmation-code-inputs">
                    <div class="confirmation-code-boxes">
                        @for (int i = 0; i < 6; i++)
                        {
                            <input type="text" maxlength="1" pattern="[0-9]*" inputmode="numeric" class="form-control code-box" id="codeBox_@i" name="ConfirmationCodeDigits" required style="width:2.5em;display:inline-block;text-align:center;margin-right:0.3em;" />
                        }
                    </div>
                </div>

                <p>Enviamos um código de confimação para o seu email, digite-o aqui para conferirmos se realmente é você!</p>
                <input type="hidden" asp-for="ConfirmationCode" id="ConfirmationCode" value="" />
                <script>
                    const form = document.querySelector('form[method="post"]');
                    const hiddenInput = document.getElementById('ConfirmationCode');

                    document.querySelectorAll('.code-box').forEach((box, idx, arr) => {
                        box.addEventListener('input', function (e) {
                            if (this.value.length === 1 && idx < arr.length - 1) {
                                arr[idx + 1].focus();
                            }
                            if (idx === arr.length - 1 && this.value.length === 1) {
                                fullCode = '';

                                for (let i=0; i<6; i++){
                                    console.log()
                                    fullCode += document.getElementById(`codeBox_${i}`).value;
                                }   

                                hiddenInput.value = fullCode;
                               
                            }
                        });
                        box.addEventListener('keydown', function (e) {
                            if (e.key === 'Backspace' && this.value === '' && idx > 0) {
                                arr[idx - 1].focus();
                            }
                        });
                    });

                    document.getElementById("RightBox").classList.add('swap');
                </script>

                <style>
                    .confirmation-code-boxes {
                        flex-direction: row !important;
                        align-items: center;
                        justify-content: center;
                        gap: 20px;
                    }

                    .confirmation-code-boxes .code-box {
                        font-size: 1.5em;
                        margin-right: 0.3em;
                        text-align: center;
                        width: 1em;
                        height: 3em;
                        display: inline-block;
                        border-radius: 10px;
                    }

                    #RightBox {
                        width: 50% !important;
                        border-radius: 15px 15px 15px 15px;
                    }

                    @@media (max-width: 898px) {
                        #RightBox {
                            width: 100vw !important;
                            border-radius: 0 !important;
                        }
                    }
                </style>
                
                <button type="submit" class="btn btn-primary">Confirmar código</button>
            </form>
        }
        else
        {
            <h3>Criando uma nova conta, você pode receber notícias, fazer pedidos, receber descontos e muito mais!!</h3>

            <div class="BottomRightBox">
                <h4>Você já tem uma conta?</h4>
                <a asp-area="Identity" asp-page="/Account/Login">Login</a>
            </div>
        }  
        
    </div>
</div>

@section Scripts {

    <partial name="_ValidationScriptsPartial" />    
}
